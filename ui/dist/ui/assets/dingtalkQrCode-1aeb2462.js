import{cp as g,dv as u,d1 as _,fg as m,cq as f,d0 as h,cx as k,cy as y,cB as o,cJ as v,cC as C,cY as w}from"./index-1a322249.js";const q="/ui/assets/logo_dingtalk-ba6ce262.svg",x={class:"flex-center mb-16"},Q=g({__name:"dingtalkQrCode",props:{config:{}},setup(a){const n=a,r=u(),{user:c}=_(),{load:d}=m("https://g.alicdn.com/dingding/h5-dingtalk-login/0.21.0/ddlogin.js"),s=f(!1),p=async()=>{try{if(await d(!0),!s.value)return;const e={appKey:n.config.app_key,appSecret:n.config.app_secret,corp_id:n.config.corp_id},t=encodeURIComponent(window.location.origin);window.DTFrameLogin({id:"ding-talk-qr",width:280,height:280},{redirect_uri:t,client_id:e.appKey,scope:"openid corpid",response_type:"code",state:"fit2cloud-ding-qr",prompt:"consent",corpId:e.corp_id},i=>{const l=i.authCode;c.dingCallback(l).then(()=>{r.push({name:"home"})})},i=>{w(i)})}catch(e){console.error(e)}};return h(()=>n.config,e=>{e.app_key&&e.corp_id&&(s.value=!0,p())},{immediate:!0}),(e,t)=>(k(),y(C,null,[o("div",x,[t[0]||(t[0]=o("img",{src:q,alt:"",width:"24px",class:"mr-4"},null,-1)),o("h2",null,v(e.$t("views.system.authentication.scanTheQRCode.dingtalkQrCode")),1)]),t[1]||(t[1]=o("div",{class:"ding-talk-qrName"},[o("div",{id:"ding-talk-qr"})],-1))],64))}});export{Q as default};
