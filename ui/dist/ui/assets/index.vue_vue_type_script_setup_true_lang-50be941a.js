import{cp as j,dt as W,d1 as X,cq as i,d3 as Y,cZ as f,d0 as x,cu as r,cx as A,cF as B,cA as t,cB as u,cz as o,cE as ee,cK as b,cJ as c,cH as ae,cN as te,ef as oe,dh as y,el as le,ed as S,cT as se}from"./index-1a322249.js";const ne={class:"content-height"},ie={class:"update-info flex border-r-4 mb-16 p-8-12"},re={class:"mt-4"},de={class:"ml-12 lighter"},ue={class:"dialog-footer"},me=j({__name:"index",emits:["refresh"],setup(pe,{expose:z,emit:U}){var C;const L=W(),{params:{id:m,documentId:P}}=L,{model:T,prompt:w,user:F}=X(),k=U,p=i(!1),d=i(!1),Q=i(null),V=i([]),v=i(""),g=i("error"),I={all:["0","1","2","3","4","5","n"],error:["0","1","3","4","5","n"]},$=i(),M=i(),q=(C=F.userInfo)==null?void 0:C.id,l=i(w.get(q)),D=Y({model_id:[{required:!0,message:f("views.application.applicationForm.form.aiModel.placeholder"),trigger:"blur"}],prompt:[{required:!0,message:f("views.application.applicationForm.form.prompt.placeholder"),trigger:"blur"}]});x(d,e=>{var a;e||(l.value=w.get(q),(a=$.value)==null||a.clearValidate())});const G=(e,a,_)=>{M.value=_,E(),V.value=e,v.value=a,d.value=!0},H=async e=>{e&&await e.validate((a,_)=>{var h;if(a){if(w.save((h=F.userInfo)==null?void 0:h.id,l.value),v.value==="paragraph"){const s={...l.value,paragraph_id_list:V.value};oe.batchGenerateRelated(m,P,s,p).then(()=>{y(f("views.document.generateQuestion.successMessage")),k("refresh"),d.value=!1})}else if(v.value==="document"){const s={...l.value,document_id_list:V.value,state_list:I[g.value]};le.batchGenerateRelated(m,s,p).then(()=>{y(f("views.document.generateQuestion.successMessage")),k("refresh"),d.value=!1})}else if(v.value==="dataset"){const s={...l.value,state_list:I[g.value]};S.generateRelated(m||M.value,s,p).then(()=>{y(f("views.document.generateQuestion.successMessage")),d.value=!1})}}})};function E(){p.value=!0,S.getDatasetModel(m||M.value).then(e=>{Q.value=se.groupBy(e==null?void 0:e.data,"provider"),p.value=!1}).catch(()=>{p.value=!1})}return z({open:G}),(e,a)=>{const _=r("AppIcon"),h=r("ModelSelect"),s=r("el-form-item"),J=r("el-input"),N=r("el-radio"),K=r("el-radio-group"),O=r("el-form"),R=r("el-button"),Z=r("el-dialog");return A(),B(Z,{title:e.$t("views.document.generateQuestion.title"),modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=n=>d.value=n),width:"650","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[u("span",ue,[o(R,{onClick:a[3]||(a[3]=ee(n=>d.value=!1,["prevent"]))},{default:t(()=>[b(c(e.$t("common.cancel")),1)]),_:1}),o(R,{type:"primary",onClick:a[4]||(a[4]=n=>H($.value)),disabled:!ae(T)||p.value},{default:t(()=>[b(c(e.$t("common.confirm")),1)]),_:1},8,["disabled"])])]),default:t(()=>[u("div",ne,[o(O,{ref_key:"FormRef",ref:$,model:l.value,rules:D,"label-position":"top","require-asterisk-position":"right"},{default:t(()=>[u("div",ie,[u("div",re,[o(_,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),u("div",de,[u("p",null,c(e.$t("views.document.generateQuestion.tip1",{data:"{data}"})),1),u("p",null,c(e.$t("views.document.generateQuestion.tip2")+"<question></question>"+e.$t("views.document.generateQuestion.tip3")),1),u("p",null,c(e.$t("views.document.generateQuestion.tip4")),1)])]),o(s,{label:e.$t("views.application.applicationForm.form.aiModel.label"),prop:"model_id"},{default:t(()=>[o(h,{modelValue:l.value.model_id,"onUpdate:modelValue":a[0]||(a[0]=n=>l.value.model_id=n),placeholder:e.$t("views.application.applicationForm.form.aiModel.placeholder"),options:Q.value,showFooter:"","model-type":"LLM"},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"]),o(s,{label:e.$t("views.application.applicationForm.form.prompt.label"),prop:"prompt"},{default:t(()=>[o(J,{modelValue:l.value.prompt,"onUpdate:modelValue":a[1]||(a[1]=n=>l.value.prompt=n),placeholder:e.$t("views.application.applicationForm.form.prompt.placeholder"),rows:7,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),["document","dataset"].includes(v.value)?(A(),B(s,{key:0,label:e.$t("components.selectParagraph.title"),prop:"state"},{default:t(()=>[o(K,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=n=>g.value=n),class:"radio-block"},{default:t(()=>[o(N,{value:"error",size:"large"},{default:t(()=>[b(c(e.$t("components.selectParagraph.error")),1)]),_:1}),o(N,{value:"all",size:"large"},{default:t(()=>[b(c(e.$t("components.selectParagraph.all")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):te("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"])}}});export{me as _};
