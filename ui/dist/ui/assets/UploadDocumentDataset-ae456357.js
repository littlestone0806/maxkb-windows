import{cp as j,cq as w,d0 as oe,cu as u,cx as r,cF as h,cA as l,cB as t,cz as o,cE as M,cK as v,cJ as s,cN as B,cy as x,cC as Z,cD as Y,cT as ce,dg as de,cr as O,c_ as re,cZ as U,cH as H,em as se,cR as G,d1 as ne,d3 as pe,ct as _e,cU as me,cV as ue,cv as ve,el as J,en as $e,dv as fe,e5 as we,eo as ge,eg as be,cY as ee,ep as he,dt as ye,dh as te}from"./index-1a322249.js";import{_ as ie}from"./ParagraphForm.vue_vue_type_script_setup_true_lang-5e53ebbc.js";const ke={class:"bold title p-24",style:{"padding-bottom":"0"}},Ce={class:"flex align-center"},Ve={class:"p-24",style:{"padding-top":"16px"}},Te={key:1,class:"p-24"},Re={class:"dialog-footer"},Se=j({__name:"EditParagraphDialog",props:{isConnect:Boolean},emits:["updateContent"],setup(z,{expose:S,emit:L}){const T=L,k=w(!1),a=w({}),$=w(),d=w(),_=w(!1),b=w("");oe(k,i=>{i||(a.value={})});const C=i=>{a.value=ce.cloneDeep(i),k.value=!0};function R(i,e){a.value.problem_list.splice(e,1)}function y(){var i,e,n;b.value.trim()&&((i=a.value)!=null&&i.problem_list.some(c=>c.content===b.value.trim())||(n=(e=a.value)==null?void 0:e.problem_list)==null||n.push({content:b.value.trim()}),b.value="",_.value=!1)}function E(){_.value=!0,de(()=>{var i;(i=d.value)==null||i.focus()})}const f=async()=>{var i,e;await((i=$.value)==null?void 0:i.validate())&&(T("updateContent",{problem_list:a.value.problem_list,...(e=$.value)==null?void 0:e.form}),k.value=!1)};return S({open:C}),(i,e)=>{const n=u("el-col"),c=u("el-divider"),p=u("Plus"),g=u("el-icon"),D=u("el-button"),A=u("el-input"),V=u("auto-tooltip"),I=u("TagEllipsis"),X=u("el-scrollbar"),Q=u("el-row"),q=u("el-dialog");return r(),h(q,{title:i.$t("views.paragraph.editParagraph"),modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=P=>k.value=P),width:"80%","destroy-on-close":"",class:"paragraph-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:l(()=>[t("span",Re,[o(D,{onClick:e[2]||(e[2]=M(P=>k.value=!1,["prevent"]))},{default:l(()=>[v(s(i.$t("common.cancel")),1)]),_:1}),o(D,{type:"primary",onClick:f},{default:l(()=>[v(s(i.$t("common.save")),1)]),_:1})])]),default:l(()=>[z.isConnect?(r(),h(Q,{key:0},{default:l(()=>[o(n,{span:18,class:"p-24"},{default:l(()=>[o(ie,{ref_key:"paragraphFormRef",ref:$,data:a.value,isEdit:!0},null,8,["data"])]),_:1}),o(n,{span:6,class:"border-l",style:{width:"300px"}},{default:l(()=>[t("p",ke,[t("span",Ce,[t("span",null,s(i.$t("views.paragraph.relatedProblem.title")),1),o(c,{direction:"vertical",class:"mr-4"}),o(D,{text:"",onClick:E},{default:l(()=>[o(g,null,{default:l(()=>[o(p)]),_:1})]),_:1})])]),o(X,{height:"500px"},{default:l(()=>[t("div",Ve,[_.value?(r(),h(A,{key:0,modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=P=>b.value=P),placeholder:i.$t("views.paragraph.relatedProblem.placeholder"),onChange:y,onBlur:e[1]||(e[1]=P=>_.value=!1),ref_key:"inputRef",ref:d,class:"mb-8"},null,8,["modelValue","placeholder"])):B("",!0),(r(!0),x(Z,null,Y(a.value.problem_list,(P,N)=>(r(),h(I,{key:N,onClose:K=>R(P,N),class:"question-tag",type:"info",effect:"plain",closable:""},{default:l(()=>[o(V,{content:P.content},{default:l(()=>[v(s(P.content),1)]),_:2},1032,["content"])]),_:2},1032,["onClose"]))),128))])]),_:1})]),_:1})]),_:1})):(r(),x("div",Te,[o(ie,{ref_key:"paragraphFormRef",ref:$,data:a.value,isEdit:!0},null,8,["data"])]))]),_:1},8,["title","modelValue"])}}}),Le={class:"flex-between"},De={class:"lighter mt-12"},Fe={class:"lighter mt-12"},Pe=j({__name:"ParagraphList",props:{modelValue:{},isConnect:{type:Boolean}},emits:["update:modelValue"],setup(z,{emit:S}){const L=w(30),T=w(1),k=w(0),a=w(),$=S,d=w(!1),_=(f,i)=>{k.value=i,a.value.open(f)},b=z,C=O(()=>b.modelValue.slice(0,L.value*(T.value-1)+L.value)),R=()=>{d.value=!0,T.value+=1,d.value=!1},y=f=>{const i=[...b.modelValue];b.isConnect&&f.title&&!(f!=null&&f.problem_list.some(e=>e.content===f.title.trim()))&&f.problem_list.push({content:f.title.trim()}),i[k.value]=ce.cloneDeep(f),$("update:modelValue",i)},E=(f,i)=>{re(`${U("views.paragraph.delete.confirmTitle")}${f.title||"-"} ?`,U("views.paragraph.delete.confirmMessage"),{confirmButtonText:U("common.confirm"),confirmButtonClass:"danger"}).then(()=>{const e=[...b.modelValue];e.splice(i,1),$("update:modelValue",e)}).catch(()=>{})};return(f,i)=>{const e=u("EditPen"),n=u("el-icon"),c=u("el-button"),p=u("Delete"),g=u("el-text"),D=u("el-card"),A=u("InfiniteScroll");return r(),x("div",null,[o(A,{size:C.value.length,total:f.modelValue.length,page_size:L.value,current_page:T.value,"onUpdate:current_page":i[0]||(i[0]=V=>T.value=V),onLoad:i[1]||(i[1]=V=>R()),loading:d.value},{default:l(()=>[(r(!0),x(Z,null,Y(C.value,(V,I)=>(r(),h(D,{key:I,shadow:"never",class:"card-never mb-16"},{default:l(()=>[t("div",Le,[t("span",null,s(V.title||"-"),1),t("div",null,[o(c,{link:"",onClick:X=>_(V,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(e)]),_:1})]),_:2},1032,["onClick"]),o(c,{link:"",onClick:X=>E(V,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(p)]),_:1})]),_:2},1032,["onClick"])])]),t("div",De,s(V.content),1),t("div",Fe,[o(g,{type:"info"},{default:l(()=>[v(s(V.content.length)+" "+s(f.$t("views.paragraph.character_count")),1)]),_:2},1024)])]),_:2},1024))),128))]),_:1},8,["size","total","page_size","current_page","loading"]),o(Se,{ref_key:"EditParagraphDialogRef",ref:a,onUpdateContent:y,isConnect:f.isConnect},null,8,["isConnect"])])}}}),Ue={class:"flex-center"},xe=["src"],ze={class:"ml-4"},Ee={class:"mb-16"},Ae={key:0,class:"paragraph-list"},Me=j({__name:"ParagraphPreview",props:{data:{type:Array,default:()=>[]},isConnect:Boolean},setup(z){const S=w(0);return(L,T)=>{const k=u("el-text"),a=u("el-scrollbar"),$=u("el-tab-pane"),d=u("el-tabs");return r(),h(d,{modelValue:S.value,"onUpdate:modelValue":T[0]||(T[0]=_=>S.value=_),class:"paragraph-tabs"},{default:l(()=>[(r(!0),x(Z,null,Y(z.data,(_,b)=>(r(),h($,{key:b,label:_.name,name:b},{label:l(()=>[t("div",Ue,[t("img",{src:H(se)(_&&(_==null?void 0:_.name)),alt:"",height:"16"},null,8,xe),t("span",ze,s(_==null?void 0:_.name),1)])]),default:l(()=>[t("div",Ee,[o(k,{type:"info"},{default:l(()=>[v(s(_.content.length)+" "+s(L.$t("views.paragraph.title")),1)]),_:2},1024)]),S.value==b?(r(),x("div",Ae,[o(a,null,{default:l(()=>[o(Pe,{modelValue:_.content,"onUpdate:modelValue":C=>_.content=C,isConnect:z.isConnect},null,8,["modelValue","onUpdate:modelValue","isConnect"])]),_:2},1024)])):B("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])}}});const Ie=G(Me,[["__scopeId","data-v-666a6383"]]),Be={class:"set-rules"},Xe={class:"title-decoration-1 mb-16"},Ne={class:"set-rules__right"},He={class:"mb-4"},Qe={class:"mb-4"},qe={class:"set-rules__form"},Oe={class:"form-item mb-16"},Ze={class:"title flex align-center mb-8"},je={style:{"margin-right":"4px"}},Ke={class:"form-item mb-16"},Je={class:"title mb-8"},Ye={class:"form-item mb-16"},Ge={class:"title mb-8"},We={style:{"margin-top":"4px"}},et={class:"text-right mt-8"},tt={class:"title-decoration-1 mb-8"},lt=j({__name:"SetRules",setup(z,{expose:S}){const{dataset:L}=ne(),T=O(()=>L.documentsFiles),k=w([]),a=w("1"),$=w(!1),d=w([]),_=w(!1),b=w(!1),C=w(!0),R=pe({patterns:[],limit:500,with_filter:!0});function y(i){i&&C.value&&(d.value=d.value.map(e=>({...e,content:e.content.map(n=>({...n,problem_list:n.title.trim()?[{content:n.title.trim()}]:[]}))})),C.value=!1)}function E(){$.value=!0;let i=new FormData;T.value.forEach(e=>{e!=null&&e.raw&&i.append("file",e==null?void 0:e.raw)}),a.value==="2"&&Object.keys(R).forEach(e=>{e=="patterns"?R.patterns.forEach(n=>i.append("patterns",n)):i.append(e,R[e])}),J.postSplitDocument(i).then(e=>{const n=e.data;n.map(c=>{c.name.length>128&&(c.name=$e(c.name,128)),b.value&&c.content.map(p=>{p.problem_list=p.title.trim()?[{content:p.title.trim()}]:[]})}),d.value=n,$.value=!1}).catch(()=>{$.value=!1})}const f=()=>{J.listSplitPattern(_).then(i=>{k.value=i.data})};return oe(a,()=>{a.value==="2"&&f()}),_e(()=>{E()}),S({paragraphList:d,checkedConnect:b,loading:$}),(i,e)=>{const n=u("el-text"),c=u("el-radio"),p=u("el-card"),g=u("AppIcon"),D=u("el-tooltip"),A=u("el-option"),V=u("el-select"),I=u("el-slider"),X=u("el-switch"),Q=u("el-radio-group"),q=u("el-scrollbar"),P=u("el-checkbox"),N=u("el-button"),K=u("el-col"),W=u("el-row"),m=me("loading");return r(),x("div",Be,[o(W,null,{default:l(()=>[o(K,{span:10,class:"p-24"},{default:l(()=>[t("h4",Xe,s(i.$t("views.document.setRules.title.setting")),1),t("div",Ne,[o(q,null,{default:l(()=>[t("div",{class:"left-height",onClick:e[5]||(e[5]=M(()=>{},["stop"]))},[o(Q,{modelValue:a.value,"onUpdate:modelValue":e[4]||(e[4]=F=>a.value=F),class:"set-rules__radio"},{default:l(()=>[o(p,{shadow:"never",class:ue(["mb-16",a.value==="1"?"active":""])},{default:l(()=>[o(c,{value:"1",size:"large"},{default:l(()=>[t("p",He,s(i.$t("views.document.setRules.intelligent.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.intelligent.text")),1)]),_:1})]),_:1})]),_:1},8,["class"]),o(p,{shadow:"never",class:ue(["mb-16",a.value==="2"?"active":""])},{default:l(()=>[o(c,{value:"2",size:"large"},{default:l(()=>[t("p",Qe,s(i.$t("views.document.setRules.advanced.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.advanced.text")),1)]),_:1})]),_:1}),a.value==="2"?(r(),h(p,{key:0,shadow:"never",class:"card-never mt-16",style:{"margin-left":"30px"}},{default:l(()=>[t("div",qe,[t("div",Oe,[t("div",Ze,[t("span",je,s(i.$t("views.document.setRules.patterns.label")),1),o(D,{effect:"dark",content:i.$t("views.document.setRules.patterns.tooltip"),placement:"right"},{default:l(()=>[o(g,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])]),t("div",{onClick:e[1]||(e[1]=M(()=>{},["stop"]))},[o(V,{modelValue:R.patterns,"onUpdate:modelValue":e[0]||(e[0]=F=>R.patterns=F),multiple:"","allow-create":"","default-first-option":"",filterable:"",placeholder:i.$t("views.document.setRules.patterns.placeholder")},{default:l(()=>[(r(!0),x(Z,null,Y(k.value,(F,ae)=>(r(),h(A,{key:ae,label:F.key,value:F.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),t("div",Ke,[t("div",Je,s(i.$t("views.document.setRules.limit.label")),1),o(I,{modelValue:R.limit,"onUpdate:modelValue":e[2]||(e[2]=F=>R.limit=F),"show-input":"","show-input-controls":!1,min:50,max:1e5},null,8,["modelValue"])]),t("div",Ye,[t("div",Ge,s(i.$t("views.document.setRules.with_filter.label")),1),o(X,{size:"small",modelValue:R.with_filter,"onUpdate:modelValue":e[3]||(e[3]=F=>R.with_filter=F)},null,8,["modelValue"]),t("div",We,[o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.with_filter.text")),1)]),_:1})])])])]),_:1})):B("",!0)]),_:1},8,["class"])]),_:1},8,["modelValue"])])]),_:1}),t("div",null,[o(P,{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=F=>b.value=F),onChange:y,style:{"white-space":"normal"}},{default:l(()=>[v(s(i.$t("views.document.setRules.checkedConnect.label")),1)]),_:1},8,["modelValue"])]),t("div",et,[o(N,{onClick:E},{default:l(()=>[v(s(i.$t("views.document.buttons.preview")),1)]),_:1})])])]),_:1}),o(K,{span:14,class:"p-24 border-l"},{default:l(()=>[ve((r(),x("div",null,[t("h4",tt,s(i.$t("views.document.setRules.title.preview")),1),o(Ie,{data:d.value,"onUpdate:data":e[7]||(e[7]=F=>d.value=F),isConnect:b.value},null,8,["data","isConnect"])])),[[m,$.value]])]),_:1})]),_:1})])}}});const ot=G(lt,[["__scopeId","data-v-e792cb86"]]),st={class:"mt-8"},nt={class:"bold"},at={class:"bold"},ut={class:"bold"},it={class:"result-success"},ct={class:"bolder"},dt={class:"flex-between"},rt={class:"flex"},pt=["src"],_t={class:"ml-8"},mt=j({__name:"ResultSuccess",props:{data:{type:Object,default:()=>{}}},setup(z){const S=z,L=fe(),T=O(()=>{var a;return(a=S.data)==null?void 0:a.document_list.reduce(($,d)=>$+=d.paragraph_count,0)}),k=O(()=>{var a;return((a=S.data)==null?void 0:a.document_list.reduce(($,d)=>$+=d.char_length,0))||0});return(a,$)=>{const d=u("el-text"),_=u("el-divider"),b=u("el-button"),C=u("el-result"),R=u("SuccessFilled"),y=u("el-icon"),E=u("CircleCloseFilled"),f=u("Loading"),i=u("el-card"),e=u("el-scrollbar");return r(),h(e,null,{default:l(()=>{var n;return[o(C,{icon:"success",title:`🎉 ${a.$t("views.dataset.ResultSuccess.title")} 🎉`},{"sub-title":l(()=>{var c;return[t("div",st,[t("span",nt,s(((c=z.data)==null?void 0:c.document_list.length)||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.fileUpload.document")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",at,s(T.value||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.paragraph")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",ut,s(H(we)(k.value)||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.character")),1)]),_:1})])]}),extra:l(()=>[o(b,{onClick:$[0]||($[0]=c=>H(L).push({path:"/dataset"}))},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDataset")),1)]),_:1}),o(b,{type:"primary",onClick:$[1]||($[1]=c=>{var p;return H(L).push({path:`/dataset/${(p=z.data)==null?void 0:p.id}/document`})})},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDocument")),1)]),_:1})]),_:1},8,["title"]),t("div",it,[t("p",ct,s(a.$t("views.dataset.ResultSuccess.documentList")),1),(r(!0),x(Z,null,Y((n=z.data)==null?void 0:n.document_list,(c,p)=>(r(),h(i,{shadow:"never",class:"file-List-card mt-8",key:p},{default:l(()=>[t("div",dt,[t("div",rt,[t("img",{src:H(se)(c&&(c==null?void 0:c.name)),alt:"",width:"40"},null,8,pt),t("div",_t,[t("p",null,s(c&&(c==null?void 0:c.name)),1),o(d,{type:"info",size:"small"},{default:l(()=>[v(s(H(ge)(c&&(c==null?void 0:c.char_length))),1)]),_:2},1024)])]),t("div",null,[o(d,{type:"info",class:"mr-16"},{default:l(()=>[v(s(c&&(c==null?void 0:c.paragraph_count))+" "+s(a.$t("views.dataset.ResultSuccess.paragraph_count")),1)]),_:2},1024),c.status==="1"?(r(),h(d,{key:0},{default:l(()=>[o(y,{class:"success"},{default:l(()=>[o(R)]),_:1})]),_:1})):c.status==="2"?(r(),h(d,{key:1},{default:l(()=>[o(y,{class:"danger"},{default:l(()=>[o(E)]),_:1})]),_:1})):c.status==="0"?(r(),h(d,{key:2},{default:l(()=>[o(y,{class:"is-loading primary"},{default:l(()=>[o(f)]),_:1}),v(" "+s(a.$t("views.dataset.ResultSuccess.loading"))+"... ",1)]),_:1})):B("",!0)])])]),_:2},1024))),128))])]}),_:1})}}});const vt=G(mt,[["__scopeId","data-v-714bf56b"]]),le="/ui/assets/upload-icon-7e567789.svg",ft={class:"title-decoration-1 mb-8"},gt={class:"mt-16 mb-16"},bt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},$t={class:"mt-4"},wt={class:"ml-16 lighter"},ht={class:"el-upload__text"},yt={class:"upload__decoration"},kt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},Ct={class:"mt-4"},Vt={class:"ml-16 lighter"},Tt={class:"el-upload__text"},Rt={class:"upload__decoration"},St={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},Lt={class:"mt-4"},Dt={class:"ml-16 lighter"},Ft={class:"el-upload__text"},Pt={class:"upload__decoration"},Ut={class:"flex-between"},xt={class:"flex"},zt=["src"],Et={class:"ml-8"},At=j({__name:"UploadComponent",setup(z,{expose:S}){const{dataset:L}=ne(),T=O(()=>L.documentsFiles),k=O(()=>L.documentsType),a=w({fileType:"txt",fileList:[]}),$=pe({fileList:[{required:!0,message:U("views.document.upload.requiredMessage"),trigger:"change"}]}),d=w();oe(a.value,e=>{L.saveDocumentsType(e.fileType),L.saveDocumentsFile(e.fileList)});function _(e){J.exportQATemplate(`${e}${U("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function b(e){J.exportTableTemplate(`${e}${U("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function C(){a.value.fileList=[]}function R(e){a.value.fileList.splice(e,1)}const y=(e,n)=>{if(!((e==null?void 0:e.size)/1024/1024<100))return ee(U("views.document.upload.errorMessage1")),n.splice(-1,1),!1;if(!he(e==null?void 0:e.name,a.value.fileType))return(e==null?void 0:e.name)!==".DS_Store"&&ee(U("views.document.upload.errorMessage2")),n.splice(-1,1),!1;if((e==null?void 0:e.size)===0)return ee(U("views.document.upload.errorMessage3")),n.splice(-1,1),!1},E=()=>{ee(U("views.document.upload.errorMessage4"))},f=e=>{let n=null;de(()=>{document.querySelector(".el-upload__input")!=null&&(n=document.querySelector(".el-upload__input"),n.webkitdirectory=e)})};function i(){if(d.value)return d.value.validate(e=>e)}return _e(()=>{k.value&&(a.value.fileType=k.value),T.value&&(a.value.fileList=T.value)}),be(()=>{a.value={fileType:"txt",fileList:[]}}),S({validate:i,form:a}),(e,n)=>{var W;const c=u("el-radio-button"),p=u("el-radio-group"),g=u("AppIcon"),D=u("el-button"),A=u("el-upload"),V=u("el-form-item"),I=u("el-form"),X=u("el-text"),Q=u("Delete"),q=u("el-icon"),P=u("el-card"),N=u("el-col"),K=u("el-row");return r(),x(Z,null,[t("h4",ft,s(e.$t("views.document.uploadDocument")),1),o(I,{ref_key:"FormRef",ref:d,model:a.value,rules:$,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t("div",gt,[o(p,{modelValue:a.value.fileType,"onUpdate:modelValue":n[0]||(n[0]=m=>a.value.fileType=m),onChange:C,class:"app-radio-button-group"},{default:l(()=>[o(c,{value:"txt"},{default:l(()=>[v(s(e.$t("views.document.fileType.txt.label")),1)]),_:1}),o(c,{value:"table"},{default:l(()=>[v(s(e.$t("views.document.fileType.table.label")),1)]),_:1}),o(c,{value:"QA"},{default:l(()=>[v(s(e.$t("views.document.fileType.QA.label")),1)]),_:1})]),_:1},8,["modelValue"])]),a.value.fileType==="QA"?(r(),h(V,{key:0,prop:"fileList"},{default:l(()=>[t("div",bt,[t("div",$t,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",wt,[t("p",null,[v(s(e.$t("views.document.fileType.QA.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[1]||(n[1]=m=>_("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[2]||(n[2]=m=>_("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.QA.tip2")),1),t("p",null,s(e.$t("views.document.fileType.QA.tip3")),1)])]),o(A,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[5]||(n[5]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv,.zip",limit:50,"on-exceed":E,"on-change":y,onClick:n[6]||(n[6]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[17]||(n[17]=t("img",{src:le,alt:""},null,-1)),t("div",ht,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[3]||(n[3]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hove ml-4",onClick:n[4]||(n[4]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",yt,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV、ZIP",1)])])]),_:1},8,["file-list"])]),_:1})):a.value.fileType==="table"?(r(),h(V,{key:1,prop:"fileList"},{default:l(()=>[t("div",kt,[t("div",Ct,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",Vt,[t("p",null,[v(s(e.$t("views.document.fileType.table.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[7]||(n[7]=m=>b("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[8]||(n[8]=m=>b("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.table.tip2")),1),t("p",null,s(e.$t("views.document.fileType.table.tip3")),1),t("p",null,s(e.$t("views.document.fileType.table.tip4")),1)])]),o(A,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[11]||(n[11]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[12]||(n[12]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[18]||(n[18]=t("img",{src:le,alt:""},null,-1)),t("div",Tt,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[9]||(n[9]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[10]||(n[10]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",Rt,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV",1)])])]),_:1},8,["file-list"])]),_:1})):(r(),h(V,{key:2,prop:"fileList"},{default:l(()=>[t("div",St,[t("div",Lt,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",Dt,[t("p",null,s(e.$t("views.document.fileType.txt.tip1")),1),t("p",null,s(e.$t("views.document.fileType.txt.tip2")),1)])]),o(A,{webkitdirectory:!1,class:"w-full",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[15]||(n[15]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".txt, .md, .log, .docx, .pdf, .html,.zip,.xlsx,.xls,.csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[16]||(n[16]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[19]||(n[19]=t("img",{src:le,alt:""},null,-1)),t("div",Ft,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[13]||(n[13]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[14]||(n[14]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",Pt,[t("p",null,s(e.$t("views.document.upload.formats"))+"TXT、Markdown、PDF、DOCX、HTML、XLS、XLSX、CSV、ZIP ",1)])])]),_:1},8,["file-list"])]),_:1}))]),_:1},8,["model","rules"]),(W=a.value.fileList)!=null&&W.length?(r(),h(K,{key:0,gutter:8},{default:l(()=>[(r(!0),x(Z,null,Y(a.value.fileList,(m,F)=>(r(),h(N,{key:F,span:12,class:"mb-8"},{default:l(()=>[o(P,{shadow:"never",class:"file-List-card"},{default:l(()=>[t("div",Ut,[t("div",xt,[t("img",{src:H(se)(m&&(m==null?void 0:m.name)),alt:"",width:"40"},null,8,zt),t("div",Et,[t("p",null,s(m&&(m==null?void 0:m.name)),1),o(X,{type:"info",size:"small"},{default:l(()=>[v(s(H(ge)(m&&(m==null?void 0:m.size))||"0K"),1)]),_:2},1024)])]),o(D,{text:"",onClick:ae=>R(F)},{default:l(()=>[o(q,null,{default:l(()=>[o(Q)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):B("",!0)],64)}}});const Mt=G(At,[["__scopeId","data-v-3eb38d21"]]),It={class:"create-dataset__main flex"},Bt={class:"create-dataset__component main-calc-height"},Xt={key:0,class:"upload-document p-24"},Nt={key:0,class:"create-dataset__footer text-right border-t"},Ht=j({__name:"UploadDocumentDataset",setup(z){const{dataset:S,document:L}=ne(),T=O(()=>S.documentsFiles),k=O(()=>S.documentsType),a=fe(),$=ye(),{query:{id:d}}=$,_=w(),b=w(),C=w(!1),R=w(!1),y=w(0),E=w(null);async function f(){if(R.value=!0,await b.value.validate())if(k.value==="QA"){let p=new FormData;T.value.forEach(g=>{g!=null&&g.raw&&p.append("file",g==null?void 0:g.raw)}),d&&J.postQADocument(d,p,C).then(g=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})})}else if(k.value==="table"){let p=new FormData;T.value.forEach(g=>{g!=null&&g.raw&&p.append("file",g==null?void 0:g.raw)}),d&&J.postTableDocument(d,p,C).then(g=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})})}else y.value++>2&&(y.value=0);else R.value=!1}const i=()=>{y.value=0};function e(){S.saveDocumentsFile([]),S.saveDocumentsType("")}function n(){var g;C.value=!0;const p=[];(g=_.value)==null||g.paragraphList.map(D=>{var A;(A=_.value)!=null&&A.checkedConnect||D.content.map(V=>{delete V.problem_list}),p.push({name:D.name,paragraphs:D.content})}),d&&L.asyncPostDocument(d,p).then(()=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})}).catch(()=>{C.value=!1})}function c(){var p;((p=T.value)==null?void 0:p.length)>0?re(U("common.tip"),U("views.document.tip.saveMessage"),{confirmButtonText:U("common.confirm"),type:"warning"}).then(()=>{a.go(-1),e()}).catch(()=>{}):a.go(-1)}return be(()=>{e()}),(p,g)=>{const D=u("back-button"),A=u("el-scrollbar"),V=u("el-button"),I=u("LayoutContainer"),X=me("loading");return r(),h(I,{header:p.$t("views.document.uploadDocument"),class:"create-dataset"},{backButton:l(()=>[o(D,{onClick:c})]),default:l(()=>{var Q,q,P,N;return[ve((r(),x("div",It,[t("div",Bt,[o(A,null,{default:l(()=>[y.value===0?(r(),x("div",Xt,[o(Mt,{ref_key:"UploadComponentRef",ref:b},null,512)])):y.value===1?(r(),h(ot,{key:1,ref_key:"SetRulesRef",ref:_},null,512)):y.value===2?(r(),h(vt,{key:2,data:E.value},null,8,["data"])):B("",!0)]),_:1})])])),[[X,C.value]]),y.value!==2?(r(),x("div",Nt,[o(V,{onClick:g[0]||(g[0]=K=>H(a).go(-1)),disabled:((Q=_.value)==null?void 0:Q.loading)||C.value},{default:l(()=>[v(s(p.$t("common.cancel")),1)]),_:1},8,["disabled"]),y.value===1?(r(),h(V,{key:0,onClick:i,disabled:((q=_.value)==null?void 0:q.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.prev")),1)]),_:1},8,["disabled"])):B("",!0),y.value===0?(r(),h(V,{key:1,onClick:f,type:"primary",disabled:((P=_.value)==null?void 0:P.loading)||C.value},{default:l(()=>[v(s(k.value==="txt"?p.$t("views.document.buttons.next"):p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0),y.value===1?(r(),h(V,{key:2,onClick:n,type:"primary",disabled:((N=_.value)==null?void 0:N.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0)])):B("",!0)]}),_:1},8,["header"])}}});const Ot=G(Ht,[["__scopeId","data-v-8da16b66"]]);export{Ot as default};
