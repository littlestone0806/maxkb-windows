import{cp as S,dv as j,dt as H,cq as g,d3 as J,cZ as x,cu as i,cU as O,cx as a,cF as Z,cA as u,cz as l,cv as G,cy as c,cB as s,cJ as m,cK as C,cN as P,cH as Q,ed as V,eu as X,dh as Y,cR as ee}from"./index-1a322249.js";const te="/ui/assets/file-icon-f6759a9b.svg",se="/ui/assets/doc-icon-c067377f.svg",oe="/ui/assets/xls-icon-3234690b.svg",ne="/ui/assets/xls-icon-3234690b.svg",ae="/ui/assets/csv-icon-79f1c771.svg",ce="/ui/assets/pdf-icon-cfe4c508.svg",ie="/ui/assets/html-icon-229da585.svg",le="/ui/assets/txt-icon-dba9fd35.svg",de="/ui/assets/zip-icon-2fe548cd.svg",re="/ui/assets/md-icon-a3d25b70.svg",ue={class:"create-dataset__main flex"},_e={class:"create-dataset__component main-calc-height"},me={class:"upload-document p-24",style:{"min-width":"850px"}},he={class:"title-decoration-1 mb-8"},pe={class:"mt-16 mb-16"},fe={class:"update-info flex p-8-12 border-r-4 mb-16"},ve={class:"mt-4"},ge={class:"ml-16 lighter"},ke={class:"card-never border-r-4 mb-16"},be={style:{height:"calc(100vh - 450px)"}},ye={class:"custom-tree-node flex align-center lighter"},xe={key:0,src:te,alt:"",height:"20"},Ce={key:1,src:se,alt:"",height:"22"},we={key:2,src:oe,alt:"",height:"22"},De={key:3,src:ne,alt:"",height:"22"},Ne={key:4,src:ae,alt:"",height:"22"},Ve={key:5,src:ce,alt:"",height:"22"},We={key:6,src:ie,alt:"",height:"22"},Le={key:7,src:le,alt:"",height:"22"},$e={key:8,src:de,alt:"",height:"22"},ze={key:9,src:re,alt:"",height:"22"},Ie={class:"ml-4"},Be={class:"create-dataset__footer text-right border-t"},Me=S({__name:"ImportDocumentDataset",setup(Re){const b=j(),W=H(),{query:{id:L,folder_token:$}}=W,w=L,z=$,h=g(!1),v=g(!1),D=g(!1),p=g(null),y=g({fileType:"txt",fileList:[]}),I=J({fileList:[{required:!0,message:x("views.document.upload.requiredMessage"),trigger:"change"}]}),B={label:"name",children:"zones",isLeaf:e=>e.type!=="folder",disabled:e=>e.is_exist},M=(e,o)=>{const d=e.level===0?z:e.data.token;V.getLarkDocumentList(w,d,{},h).then(r=>{const t=r.data.files;o(t),t.forEach(_=>{var k;_.is_exist&&((k=p.value)==null||k.setChecked(_.token,!0,!1))})}).catch(r=>{console.error("Failed to load tree nodes:",r)})},R=e=>{var o,d;e?Object.values(((o=p.value)==null?void 0:o.store.nodesMap)||{}).forEach(t=>{var _;t.disabled||(_=p.value)==null||_.setChecked(t.data,!0,!1)}):(d=p.value)==null||d.setCheckedKeys([])};function T(){var r;h.value=!0,v.value=!0;const d=(((r=p.value)==null?void 0:r.getCheckedNodes())||[]).filter(t=>!t.is_exist).map(t=>({name:t.name,token:t.token,type:t.type}));if(d.length===0){v.value=!1,X(x("views.document.feishu.errorMessage1")),h.value=!1;return}V.importLarkDocument(w,d,h).then(t=>{Y(x("views.document.tip.importMessage")),v.value=!1,b.go(-1)}).catch(t=>{console.error("Failed to load tree nodes:",t)}).finally(()=>{v.value=!1}),h.value=!1}function q(){b.go(-1)}return(e,o)=>{const d=i("back-button"),r=i("el-radio-button"),t=i("el-radio-group"),_=i("AppIcon"),k=i("el-checkbox"),A=i("el-tree"),F=i("el-scrollbar"),E=i("el-form"),N=i("el-button"),U=i("LayoutContainer"),K=O("loading");return a(),Z(U,{header:e.$t("views.document.importDocument"),class:"create-dataset"},{backButton:u(()=>[l(d,{onClick:q})]),default:u(()=>[G((a(),c("div",ue,[s("div",_e,[s("div",me,[s("h4",he,m(e.$t("views.document.feishu.selectDocument")),1),l(E,{ref:"FormRef",model:y.value,rules:I,"label-position":"top","require-asterisk-position":"right"},{default:u(()=>[s("div",pe,[l(t,{modelValue:y.value.fileType,"onUpdate:modelValue":o[0]||(o[0]=f=>y.value.fileType=f),class:"app-radio-button-group"},{default:u(()=>[l(r,{value:"txt"},{default:u(()=>[C(m(e.$t("views.document.fileType.txt.label")),1)]),_:1})]),_:1},8,["modelValue"])]),s("div",fe,[s("div",ve,[l(_,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),s("div",ge,[s("p",null,m(e.$t("views.document.feishu.tip1")),1),s("p",null,m(e.$t("views.document.feishu.tip2")),1)])]),s("div",ke,[l(k,{modelValue:D.value,"onUpdate:modelValue":o[1]||(o[1]=f=>D.value=f),label:e.$t("views.document.feishu.allCheck"),size:"large",class:"ml-24",onChange:R},null,8,["modelValue","label"])]),s("div",be,[l(F,null,{default:u(()=>[l(A,{props:B,load:M,lazy:"","show-checkbox":"","node-key":"token",ref_key:"treeRef",ref:p},{default:u(({node:f,data:n})=>[s("div",ye,[n.type==="folder"?(a(),c("img",xe)):n.type==="docx"||n.name.endsWith(".docx")?(a(),c("img",Ce)):n.type==="sheet"||n.name.endsWith(".xlsx")?(a(),c("img",we)):n.name.endsWith("xls")?(a(),c("img",De)):n.name.endsWith("csv")?(a(),c("img",Ne)):n.name.endsWith(".pdf")?(a(),c("img",Ve)):n.name.endsWith(".html")?(a(),c("img",We)):n.name.endsWith(".txt")?(a(),c("img",Le)):n.name.endsWith(".zip")?(a(),c("img",$e)):n.name.endsWith(".md")?(a(),c("img",ze)):P("",!0),s("span",Ie,m(f.label),1)])]),_:1},512)]),_:1})])]),_:1},8,["model","rules"])])])])),[[K,h.value]]),s("div",Be,[l(N,{onClick:o[2]||(o[2]=f=>Q(b).go(-1))},{default:u(()=>[C(m(e.$t("common.cancel")),1)]),_:1}),l(N,{onClick:T,type:"primary",disabled:v.value},{default:u(()=>[C(m(e.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])])]),_:1},8,["header"])}}});const qe=ee(Me,[["__scopeId","data-v-0e6011a8"]]);export{qe as default};
