import{cp as q,d1 as F,dt as M,cq as n,d0 as j,cu as c,cx as g,cF as w,cA as a,cB as u,cz as s,cE as x,cK as A,cJ as p,cN as V,dy as y,cT as P,cY as k,cZ as v,ea as J,dh as C,d_ as K}from"./index-1a322249.js";const Y={class:"flex mt-8"},Z=["src"],G={class:"el-upload__tip info mt-8"},H={class:"dialog-footer"},X=q({__name:"EditAvatarDialog",emits:["refresh"],setup(Q,{expose:O,emit:$}){const{application:z}=F(),U=M(),{params:{id:h}}=U,E=$,r=n(null),d=n(null),l=n(!1),m=n(!1),f=n(null),i=n("default");j(l,e=>{e||(r.value=null,d.value=null)});const S=e=>{i.value=y(e.icon)?"custom":"default",d.value=y(e.icon)?e.icon:null,f.value=P.cloneDeep(e),l.value=!0},L=e=>{if((e==null?void 0:e.size)/1024/1024<10)r.value=e,d.value=URL.createObjectURL(e.raw);else return k(v("views.applicationOverview.appInfo.EditAvatarDialog.fileSizeExceeded")),!1};function N(){if(i.value==="default")z.asyncPutApplication(h,{icon:J},m).then(e=>{E("refresh"),C(v("common.saveSuccess")),l.value=!1});else if(i.value==="custom"&&r.value){let e=new FormData;e.append("file",r.value.raw),K.putAppIcon(h,e,m).then(o=>{E("refresh"),C(v("common.saveSuccess")),l.value=!1})}else k(v("views.applicationOverview.appInfo.EditAvatarDialog.uploadImagePrompt"))}return O({open:S}),(e,o)=>{const b=c("AppAvatar"),D=c("el-radio"),_=c("el-button"),R=c("el-upload"),B=c("el-radio-group"),T=c("el-dialog");return g(),w(T,{title:e.$t("views.applicationOverview.appInfo.EditAvatarDialog.title"),modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value=t),"close-on-click-modal":!1,"close-on-press-escape":!1,width:"550"},{footer:a(()=>[u("span",H,[s(_,{onClick:o[1]||(o[1]=x(t=>l.value=!1,["prevent"]))},{default:a(()=>[A(p(e.$t("common.cancel")),1)]),_:1}),s(_,{type:"primary",onClick:N,loading:m.value},{default:a(()=>[A(p(e.$t("common.save")),1)]),_:1},8,["loading"])])]),default:a(()=>[s(B,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value=t),class:"radio-block mb-16"},{default:a(()=>[s(D,{value:"default"},{default:a(()=>{var t,I;return[u("p",null,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.default")),1),(t=f.value)!=null&&t.name?(g(),w(b,{key:0,name:(I=f.value)==null?void 0:I.name,pinyinColor:"",class:"mt-8 mb-8",shape:"square",size:32},null,8,["name"])):V("",!0)]}),_:1}),s(D,{value:"custom"},{default:a(()=>[u("p",null,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.customizeUpload")),1),u("div",Y,[d.value?(g(),w(b,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-16"},{default:a(()=>[u("img",{src:d.value,alt:""},null,8,Z)]),_:1})):V("",!0),s(R,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":L},{default:a(()=>[s(_,{icon:"Upload",disabled:i.value!=="custom"},{default:a(()=>[A(p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.upload")),1)]),_:1},8,["disabled"])]),_:1},512)]),u("div",G,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.sizeTip")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"])}}});export{X as _};
